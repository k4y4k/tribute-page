---
kind: pipeline
type: docker
name: default

clone:
  depth: 2

steps:
  - name: install
    image: node:14
    volumes:
      - name: nodemod
        path: /node_modules
    pull: if-not-exists
    commands:
      - npm i
      - ls
    environment:
      NODE_ENV: production

  - name: cry
    privileged: true
    image: node:14
    volumes:
      - name: nodemod
        path: /node_modules
    commands:
      - echo "You heard me. Start sobbing."
      - npm run build
    environment:
      NODE_ENV: production

volumes:
  - name: nodemod
    temp: {}
